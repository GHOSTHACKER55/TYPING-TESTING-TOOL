<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anonymous Shadows Typing Test</title>
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Share Tech Mono', monospace;
        background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
        color: #ffffff;
        text-align: center;
        padding: 20px;
        margin: 0;
    }

    h1 {
        font-family: 'Orbitron', sans-serif;
        color: #00ffcc;
        font-size: 2em;
        margin-bottom: 25px;
        text-shadow: 0 0 10px #00ffcc, 0 0 20px #00ffcc;
    }

    #sentence {
        font-size: 1.4em;
        color: #fffb00;
        margin: 20px auto;
        padding: 20px;
        background: #1b1b2f;
        border-radius: 15px;
        width: 90%;
        user-select: none;
        box-shadow: 0 0 15px #fffb00;
    }

    textarea {
        width: 90%;
        height: 120px;
        margin-top: 20px;
        padding: 15px;
        font-size: 1.2em;
        border-radius: 15px;
        border: 2px solid #00ffcc;
        outline: none;
        resize: none;
        background: #0d0d1a;
        color: #ffffff;
        box-shadow: 0 0 10px #00ffcc inset;
    }

    button {
        margin-top: 20px;
        padding: 15px 30px;
        font-size: 1.2em;
        font-family: 'Orbitron', sans-serif;
        background: linear-gradient(45deg, #00ffcc, #ff00ff);
        color: #000;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        box-shadow: 0 0 15px #00ffcc, 0 0 25px #ff00ff;
        transition: 0.3s;
    }

    button:hover {
        background: linear-gradient(45deg, #ff00ff, #00ffcc);
        box-shadow: 0 0 25px #00ffcc, 0 0 35px #ff00ff;
    }

    #results {
        margin-top: 25px;
        font-size: 1.5em;
        color: #fffb00;
        text-shadow: 0 0 8px #fffb00;
    }

</style>
</head>
<body>

<h1>Anonymous Shadows Typing Test</h1>

<div id="sentence"></div>

<textarea id="typingArea" placeholder="Type the sentence above exactly here..."></textarea><br>
<button id="checkBtn">Check Accuracy & WPM</button>

<p id="results">Your results will appear here!</p>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/10.6.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore-compat.js"></script>

<script>
/* ---------------- FIREBASE CONFIG ---------------- */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "anonymous-shadows.firebaseapp.com",
  projectId: "anonymous-shadows",
  storageBucket: "anonymous-shadows.appspot.com",
  messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
/* ------------------------------------------------ */

const sentences = [
    "How are you? How is your day going?",
    "The quick brown fox jumps over the lazy dog.",
    "Typing speed tests help improve your keyboard skills.",
    "Anonymous Shadows is a cyber-style typing tool.",
    "Practice makes perfect in everything you do.",
    "Challenge yourself daily to become faster.",
    "Keep typing and never give up on learning.",
    "Push yourself harder to become the best."
];

const sentenceDiv = document.getElementById("sentence");
const textarea = document.getElementById("typingArea");
const results = document.getElementById("results");
const button = document.getElementById("checkBtn");

let startTime = null;
let currentSentence = "";

// Choose a new random sentence
function newSentence() {
    currentSentence = sentences[Math.floor(Math.random() * sentences.length)];
    sentenceDiv.innerText = currentSentence;
    textarea.value = "";
    results.innerText = "Your results will appear here!";
    results.style.color = "#fffb00";
    startTime = null;
}

// Initialize first sentence
newSentence();

// Start timer on first input
textarea.addEventListener("input", () => {
    if (!startTime) startTime = new Date();
});

// Calculate accuracy and WPM
button.addEventListener("click", async () => {
    const typed = textarea.value.trim();
    if (!typed) {
        results.innerText = "Please type the sentence!";
        results.style.color = "#ff4444";
        return;
    }

    let correctChars = 0;
    for (let i = 0; i < typed.length; i++) {
        if (typed[i] === currentSentence[i]) correctChars++;
    }

    const accuracy = Math.min(100, Math.round((correctChars / currentSentence.length) * 100));

    // Calculate WPM
    const endTime = new Date();
    const timeMinutes = (endTime - startTime) / 60000; // convert ms to minutes
    const wordCount = typed.split(" ").length;
    const wpm = Math.round(wordCount / timeMinutes);

    results.innerText = `Accuracy: ${accuracy}% | WPM: ${wpm}`;

    // Save to Firestore
    try {
        await db.collection("typingResults").add({
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
            accuracy: accuracy,
            wpm: wpm,
            sentence: currentSentence
        });
        console.log("Result saved to Firestore!");
    } catch(e) {
        console.error("Error saving result: ", e);
    }

    // Load new sentence after 3 seconds
    setTimeout(newSentence, 3000);
});
</script>
</body>
</html>