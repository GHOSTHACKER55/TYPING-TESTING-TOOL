<!DOCTYPE html>
<html>
<head>
    <title>Anonymous Shadows Admin</title>
</head>
<body>
    <h1>Admin Panel</h1>
    <div id="visits"></div>
    <div id="typing"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCtjMyazrVnGFRASQOGjqeR_U9novXC15k",
            authDomain: "anonymous-shadows.firebaseapp.com",
            projectId: "anonymous-shadows",
            storageBucket: "anonymous-shadows.firebasestorage.app",
            messagingSenderId: "939891243370",
            appId: "1:939891243370:web:8db01f36d0afa9a58b8d13",
            vapidKey: "BPRhIQxTwlYR0K3pZD8QomSlZFBbZz4txXmbH-i0Q5oWaf54VTVjyZ4TqsfpBgac2IMOpeOY59DMb6lsoiMewSU"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadVisits() {
            const q = query(collection(db, "userVisits"), orderBy("timestamp", "desc"));
            const snapshot = await getDocs(q);
            let html = "<h2>User Visits:</h2><ul>";
            snapshot.forEach(doc => {
                const data = doc.data();
                html += `<li>${data.timestamp?.toDate()} - ${data.userAgent} - ${data.page}</li>`;
            });
            html += "</ul>";
            document.getElementById("visits").innerHTML = html;
        }

        async function loadTyping() {
            const q = query(collection(db, "typingSessions"), orderBy("timestamp", "desc"));
            const snapshot = await getDocs(q);
            let html = "<h2>Typing Sessions:</h2><ul>";
            snapshot.forEach(doc => {
                const data = doc.data();
                html += `<li>${data.timestamp?.toDate()} - WPM: ${data.speed} - Sentence: ${data.sentence}</li>`;
            });
            html += "</ul>";
            document.getElementById("typing").innerHTML = html;
        }

        loadVisits();
        loadTyping();
    </script>
</body>
</html>